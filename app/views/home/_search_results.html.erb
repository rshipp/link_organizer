<%= turbo_frame_tag "search_results", target: "_top" do %>
  <% if links.present? || tags.present? %>
    <div id="search_results">
      <% if links.present? %>
        <h2>Links</h2>
        <% links.each do |link| %>
          <%= render "links/preview", link: link %>
        <% end %>
      <% end %>

      <% if tags.present? %>
        <h2>Tags</h2>
        <% tags.each do |tag| %>
          <p><%= link_to tag.name, tag %> (<%= tag.links.count %>)</p>
        <% end %>
      <% end %>
    </div>
  <% elsif query.present? %>
    <p>No results found</p>
  <% else %>
    <div id="selected_links">
      <h2>Latest links</h2>
      <% Link.last(3).each do |link| %>
        <%= render "links/preview", link: link %>
      <% end %>
    </div>

    <div id="selected_tags">
      <h2>Top tags</h2>
      <p>
        <% Tag.where(category: 'topic').map {|t| [t.links.count, t]}.sort.last(10).reverse.each do |count, tag| %>
          <%= link_to tag.name, tag %> (<%= count %>)
        <% end %>
      </p>
    </div>

    <div>
      <br/>
      <p><%= link_to "Add new links", import_links_path %></p>
    </div>
  <% end %>
<% end %>
